import{i as p,j as a}from"./index-4118f9dd.js";const{VITE_API_URL:s,VITE_API_PATH:i}={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"59487@@",BASE_URL:"/vite-works/",MODE:"production",DEV:!1,PROD:!0},d=p("openBookAria",{state:()=>({books:[],productRecords:[],allBooks:[],tempBook:{},totalPages:1}),actions:{getBooks(){const e=`${s}/api/${i}/articles`;a.get(e).then(t=>{this.books=t.data.articles}).catch(t=>{console.log(t)})},getOrder(e){const t=`${s}/api/${i}/order/${e}`;a.get(t).then(o=>{this.productRecords={...o.data.order.products},this.userLogin()}).catch(o=>{console.log(o)})},getBookOpen(e){const t=`${s}/api/${i}/admin/article/${e}`;a.get(t).then(o=>{if(o.data.article.isPublic)return!1;this.tempBook=o.data.article,this.tempBook.isPublic=!0,this.updateBook(e)}).catch(o=>{console.log(o)})},updateBook(e){const t=`${s}/api/${i}/admin/article/${e}`;a.put(t,{data:this.tempBook}).then(o=>{console.log(o.data),this.allBooks=[],document.cookie="hexToken=;expires= Thu, 01 Jan 1970 00:00:00 GMT",console.log("update cookie: "+document.cookie)}).catch(o=>{console.log(o)})},userLogin(){const e="https://vue3-course-api.hexschool.io/v2/admin/signin",t={username:"j33241796@gmail.com",password:"Jj741236p"};a.post(e,t).then(o=>{const{token:r,expired:c}=o.data;a.defaults.headers.common.Authorization=r,console.log("expired: "+c),console.log("document.cookie: "+document.cookie),this.getArticalPage()}).catch(o=>{console.log(o)})},getAllArtical(){let e="",t="";for(let o=1;o<=this.totalPages;o++){let r=`${s}/api/${i}/admin/articles?page=${o}`;a.get(r).then(c=>{if(c.data.articles.forEach(l=>{this.allBooks.push({[l.title]:l.id})}),o>=this.totalPages)for(let l in this.productRecords)e=this.productRecords[l].product.title,this.allBooks.map(n=>{Object.keys(n)[0]===e&&(t=n[e],this.getBookOpen(t))})}).catch(c=>{console.log(c)})}},getArticalPage(){const e=`${s}/api/${i}/admin/articles`;a.get(e).then(t=>{this.totalPages=t.data.pagination.total_pages,console.log("total pages: "+this.totalPages),this.getAllArtical()}).catch(t=>{console.log(t)})}},getters:{}});export{d as b};
